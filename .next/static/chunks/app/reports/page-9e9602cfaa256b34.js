(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{2099:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(851).UU)("https://mticvmyfrdmciaeipfxu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10aWN2bXlmcmRtY2lhZWlwZnh1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEwODc1OTMsImV4cCI6MjA1NjY2MzU5M30.6iudxBl6js0heW1mhoSmcXegTIN_lAN2GiFeA3plSIo")},6170:(e,t,r)=>{Promise.resolve().then(r.bind(r,9680))},6269:(e,t,r)=>{"use strict";r.d(t,{JS:()=>i,K7:()=>l,ZK:()=>o,bW:()=>s,d2:()=>g,st:()=>d,x8:()=>c,zZ:()=>n});var a=r(2099);let s=async()=>{let{data:e,error:t}=await a.N.from("categories").select("*");if(t)throw t;return e||[]},n=async e=>{let{data:t,error:r}=await a.N.from("categories").insert([e]).select().single();if(r)throw r;return t},d=async(e,t)=>{let{data:r,error:s}=await a.N.from("categories").update(t).eq("id",e).select().single();if(s)throw s;return r},l=async e=>{let{error:t}=await a.N.from("categories").delete().eq("id",e);if(t)throw t},i=async e=>{let t=a.N.from("items").select("*");e&&(t=t.eq("category_id",e));let{data:r,error:s}=await t;if(s)throw s;return r||[]},o=async e=>{let t=a.N.from("inventory").select("\n      *,\n      items:item_id (\n        id,\n        name,\n        category_id,\n        unit\n      )\n    ");e&&(t=t.eq("item_id",e));let{data:r,error:s}=await t;if(s)throw s;return r||[]},c=async(e,t)=>{let{data:r,error:s}=await a.N.from("inventory").select("*").eq("item_id",e).single();if(s&&"PGRST116"!==s.code)throw s;if(r){let e=r.quantity+t;if(e<0)throw Error("Insufficient inventory quantity");let{data:s,error:n}=await a.N.from("inventory").update({quantity:e,last_updated:new Date().toISOString()}).eq("id",r.id).select().single();if(n)throw n;return s}if(t>0){let{data:r,error:s}=await a.N.from("inventory").insert([{item_id:e,quantity:t,last_updated:new Date().toISOString()}]).select().single();if(s)throw s;return r}throw Error("Cannot reduce quantity of non-existent inventory item")},g=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,{data:t,error:r}=await a.N.from("inventory").select("\n      *,\n      items:item_id (\n        id,\n        name,\n        category_id,\n        unit\n      )\n    ").lte("quantity",e);if(r)throw r;return t||[]}},8072:(e,t,r)=>{"use strict";r.d(t,{LH:()=>s,VE:()=>d,_O:()=>l,oC:()=>n});var a=r(2099);let s=async e=>{try{let t=a.N.from("purchase_orders").select("*");e&&(t=t.eq("status",e));let{data:r,error:s}=await t.order("order_date",{ascending:!1});if(s)throw console.error("Supabase error in getPurchaseOrders:",s),s.message.includes("does not exist")&&console.warn("The purchase_orders table might not exist yet. Make sure to run database initialization scripts."),Error("Database error: ".concat(s.message));return r||[]}catch(e){throw console.error("Error in getPurchaseOrders:",e),e}},n=async e=>{let t={...e,order_date:new Date().toISOString(),status:e.status||"draft"},{data:r,error:s}=await a.N.from("purchase_orders").insert([t]).select().single();if(s)throw s;return r},d=async e=>{let{data:t,error:r}=await a.N.from("purchase_items").insert([e]).select().single();if(r)throw r;return t},l=async(e,t,r)=>{try{let s=new Date(e,t-1,1).toISOString(),n=new Date(e,t,0).toISOString(),{data:d,error:l}=await a.N.from("maintenance_requests").select("id").gte("reported_date",s).lte("reported_date",n);if(l){if(l.message.includes("does not exist"))return console.warn("Maintenance requests table does not exist yet. Creating empty purchase order."),i(e,t,r);throw l}if(!d||0===d.length)return console.log("No maintenance requests found for the specified month. Creating empty purchase order."),i(e,t,r);let o=d.map(e=>e.id),{data:c,error:g}=await a.N.from("maintenance_items").select("*").in("maintenance_id",o);if(g){if(g.message.includes("does not exist"))return console.warn("Maintenance items table does not exist yet. Creating empty purchase order."),i(e,t,r);throw g}if(!c||0===c.length)return console.log("No maintenance items found for the specified month. Creating empty purchase order."),i(e,t,r);let m={};c.forEach(e=>{m[e.item_id]||(m[e.item_id]=0),m[e.item_id]+=e.quantity_needed});let{data:x,error:h}=await a.N.from("purchase_orders").insert([{order_date:new Date().toISOString(),status:"draft",created_by:r,notes:"Auto-generated order for ".concat(e,"-").concat(t.toString().padStart(2,"0"))}]).select().single();if(h)throw h;if(Object.keys(m).length>0){let e=Object.entries(m).map(e=>{let[t,r]=e;return{purchase_order_id:x.id,item_id:t,quantity:r}}),{error:t}=await a.N.from("purchase_items").insert(e);if(t)throw t}return x}catch(e){throw console.error("Error generating monthly purchase order:",e),e}},i=async(e,t,r)=>{let{data:s,error:n}=await a.N.from("purchase_orders").insert([{order_date:new Date().toISOString(),status:"draft",created_by:r,notes:"Auto-generated order for ".concat(e,"-").concat(t.toString().padStart(2,"0")," (No maintenance items found)")}]).select().single();if(n)throw n;return s}},9680:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(5155),s=r(2115),n=r(6874),d=r.n(n),l=r(9684),i=r(6269),o=r(8072);function c(){let[e,t]=(0,s.useState)("month"),[r,n]=(0,s.useState)({total:0,pending:0,inProgress:0,completed:0,completionRate:0,averageCompletionDays:0}),[c,g]=(0,s.useState)({lowStockCount:0,lowStockItems:[]}),[m,x]=(0,s.useState)({total:0,totalAmount:0,pending:0,completed:0}),[h,u]=(0,s.useState)(!0),[b,p]=(0,s.useState)(null),y=new Date,w=y.getFullYear(),f=y.getMonth(),k=()=>{let t=new Date;return"month"===e?t=new Date(w,f,1):"quarter"===e?t=new Date(w,3*Math.floor(f/3),1):"year"===e&&(t=new Date(w,0,1)),{start:t,end:y}};return(0,s.useEffect)(()=>{(async()=>{u(!0),p(null);try{let e=k(),t=(await (0,l.Om)()).filter(t=>{let r=new Date(t.reported_date);return r>=e.start&&r<=e.end}),r=t.length,a=t.filter(e=>"pending"===e.status||"approved"===e.status).length,s=t.filter(e=>"in_progress"===e.status).length,d=t.filter(e=>"completed"===e.status).length,c=r>0?d/r*100:0,m=0,h=0;t.forEach(e=>{if("completed"===e.status&&e.completion_date){let t=new Date(e.reported_date),r=new Date(e.completion_date),a=Math.floor((r.getTime()-t.getTime())/864e5);m+=a,h++}});let u=h>0?Math.round(m/h):0;n({total:r,pending:a,inProgress:s,completed:d,completionRate:parseFloat(c.toFixed(1)),averageCompletionDays:u});let b=await (0,i.d2)(5);g({lowStockCount:b.length,lowStockItems:b});let p=(await (0,o.LH)()).filter(t=>{let r=new Date(t.order_date);return r>=e.start&&r<=e.end}),y=p.length,w=p.filter(e=>"draft"===e.status||"submitted"===e.status||"approved"===e.status||"ordered"===e.status).length,f=p.filter(e=>"received"===e.status||"completed"===e.status).length,N=p.reduce((e,t)=>e+(t.total_amount||0),0);x({total:y,totalAmount:N,pending:w,completed:f})}catch(e){console.error("Error fetching report data:",e instanceof Error?e.message:"An unknown error occurred"),p("حدث خطأ أثناء تحميل بيانات التقارير. الرجاء المحاولة مرة أخرى.")}finally{u(!1)}})()},[e]),(0,a.jsxs)("div",{className:"container mx-auto bg-gray-50 dark:bg-gray-900 min-h-screen p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6 dark:text-white",children:"التقارير والإحصائيات"}),b&&(0,a.jsx)("div",{className:"bg-red-100 border-r-4 border-red-500 text-red-700 p-4 mb-6 rounded-md dark:bg-red-900/30 dark:border-red-800 dark:text-red-400",children:(0,a.jsx)("p",{children:b})}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4 mb-8 dark:bg-gray-800",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:"الفترة الزمنية"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>t("month"),className:"px-4 py-2 rounded-md ".concat("month"===e?"bg-teal-600 text-white dark:bg-teal-700":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-200"),children:"شهري"}),(0,a.jsx)("button",{onClick:()=>t("quarter"),className:"px-4 py-2 rounded-md ".concat("quarter"===e?"bg-teal-600 text-white dark:bg-teal-700":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-200"),children:"ربع سنوي"}),(0,a.jsx)("button",{onClick:()=>t("year"),className:"px-4 py-2 rounded-md ".concat("year"===e?"bg-teal-600 text-white dark:bg-teal-700":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-200"),children:"سنوي"})]})]}),h?(0,a.jsx)("div",{className:"text-center py-10 dark:text-gray-300",children:(0,a.jsx)("p",{className:"text-lg",children:"جاري تحميل البيانات..."})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden mb-8 dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"bg-teal-50 p-4 border-b border-teal-100 dark:bg-teal-900/20 dark:border-teal-900/30",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-teal-800 dark:text-teal-300",children:"إحصائيات طلبات الصيانة"}),(0,a.jsx)(d(),{href:"/reports/maintenance",className:"text-teal-600 hover:underline dark:text-teal-400",children:"عرض التقرير المفصل"})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-gray-50 rounded-lg dark:bg-gray-700",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"إجمالي الطلبات"}),(0,a.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:r.total})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg dark:bg-yellow-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"قيد الانتظار"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:r.pending})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg dark:bg-blue-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"قيد التنفيذ"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:r.inProgress})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg dark:bg-green-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"مكتملة"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:r.completed})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg dark:bg-purple-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"معدل الإنجاز"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:[r.completionRate,"%"]})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-indigo-50 rounded-lg dark:bg-indigo-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"متوسط مدة الإنجاز"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-indigo-700 dark:text-indigo-300",children:[r.averageCompletionDays," يوم"]})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"bg-blue-50 p-4 border-b border-blue-100 dark:bg-blue-900/20 dark:border-blue-900/30",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-blue-800 dark:text-blue-300",children:"حالة المخزون"}),(0,a.jsx)(d(),{href:"/inventory",className:"text-blue-600 hover:underline dark:text-blue-400",children:"إدارة المخزون"})]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("h3",{className:"font-medium dark:text-white",children:"الأصناف منخفضة المخزون"}),(0,a.jsxs)("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs dark:bg-red-900/30 dark:text-red-300",children:[c.lowStockCount," صنف"]})]}),c.lowStockItems.length>0?(0,a.jsxs)("ul",{className:"divide-y dark:divide-gray-700",children:[c.lowStockItems.slice(0,5).map(e=>(0,a.jsxs)("li",{className:"py-2 flex justify-between dark:text-gray-300",children:[(0,a.jsx)("span",{children:e.items.name}),(0,a.jsxs)("span",{className:"font-bold text-red-600 dark:text-red-400",children:[e.quantity," ",e.items.unit]})]},e.id)),c.lowStockItems.length>5&&(0,a.jsx)("li",{className:"py-2 text-center text-blue-600 hover:underline dark:text-blue-400",children:(0,a.jsxs)(d(),{href:"/inventory?showLowStock=true",children:["عرض الكل (",c.lowStockItems.length,")"]})})]}):(0,a.jsx)("p",{className:"text-gray-500 text-center py-4 dark:text-gray-400",children:"لا توجد أصناف منخفضة المخزون"})]}),(0,a.jsx)(d(),{href:"/inventory/report",className:"btn bg-blue-600 hover:bg-blue-700 text-white w-full py-2 px-4 rounded-md block text-center dark:bg-blue-700 dark:hover:bg-blue-600",children:"تقرير المخزون الشامل"})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"bg-purple-50 p-4 border-b border-purple-100 dark:bg-purple-900/20 dark:border-purple-900/30",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-purple-800 dark:text-purple-300",children:"حالة المشتريات"}),(0,a.jsx)(d(),{href:"/purchase-orders",className:"text-purple-600 hover:underline dark:text-purple-400",children:"عرض طلبات الشراء"})]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-gray-50 rounded-lg dark:bg-gray-700",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"إجمالي الطلبات"}),(0,a.jsx)("p",{className:"text-2xl font-bold dark:text-white",children:m.total})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg dark:bg-green-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"المبلغ الإجمالي"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:[m.totalAmount.toLocaleString()," ريال"]})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg dark:bg-yellow-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"قيد الإجراء"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:m.pending})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg dark:bg-blue-900/20",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1 dark:text-gray-400",children:"مكتملة"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:m.completed})]})]}),(0,a.jsx)(d(),{href:"/reports/purchases",className:"btn bg-purple-600 hover:bg-purple-700 text-white w-full py-2 px-4 rounded-md block text-center dark:bg-purple-700 dark:hover:bg-purple-600",children:"تقرير المشتريات الشامل"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden mb-8 dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"p-4 border-b dark:border-gray-700",children:(0,a.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:"التقارير الشهرية"})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)(d(),{href:"/reports/monthly/".concat(w,"/").concat(f+1,"/maintenance"),className:"p-4 border rounded-lg bg-gray-50 hover:bg-gray-100 flex flex-col items-center dark:bg-gray-700 dark:border-gray-600 dark:hover:bg-gray-600",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-teal-600 mb-2 dark:text-teal-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,a.jsx)("span",{className:"text-center font-medium dark:text-white",children:"تقرير الصيانة الشهري"})]}),(0,a.jsxs)(d(),{href:"/reports/monthly/".concat(w,"/").concat(f+1,"/inventory"),className:"p-4 border rounded-lg bg-gray-50 hover:bg-gray-100 flex flex-col items-center dark:bg-gray-700 dark:border-gray-600 dark:hover:bg-gray-600",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-600 mb-2 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),(0,a.jsx)("span",{className:"text-center font-medium dark:text-white",children:"تقرير حركة المخزون"})]}),(0,a.jsxs)(d(),{href:"/reports/monthly/".concat(w,"/").concat(f+1,"/purchases"),className:"p-4 border rounded-lg bg-gray-50 hover:bg-gray-100 flex flex-col items-center dark:bg-gray-700 dark:border-gray-600 dark:hover:bg-gray-600",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-purple-600 mb-2 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,a.jsx)("span",{className:"text-center font-medium dark:text-white",children:"تقرير المشتريات الشهري"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"p-4 border-b dark:border-gray-700",children:(0,a.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:"تصدير التقارير"})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4 dark:text-gray-400",children:"يمكنك تصدير التقارير بصيغ مختلفة للطباعة أو المشاركة أو الأرشفة."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)("button",{className:"btn bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md dark:bg-green-700 dark:hover:bg-green-600",children:"تصدير إلى Excel"}),(0,a.jsx)("button",{className:"btn bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-md dark:bg-red-700 dark:hover:bg-red-600",children:"تصدير إلى PDF"}),(0,a.jsx)("button",{className:"btn bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md dark:bg-gray-700 dark:hover:bg-gray-600",children:"طباعة التقرير"})]})]})]})]})]})}},9684:(e,t,r)=>{"use strict";r.d(t,{Dn:()=>n,Om:()=>s,v:()=>d});var a=r(2099);let s=async(e,t,r)=>{try{let s=a.N.from("maintenance_requests").select("*");e&&(s=s.eq("complex_id",e)),t&&(s=s.eq("building_id",t)),r&&(s=s.eq("status",r));let{data:n,error:d}=await s.order("reported_date",{ascending:!1});if(d)throw console.error("Supabase error in getMaintenanceRequests:",d),d.message.includes("does not exist")&&console.warn("The maintenance_requests table might not exist yet. Make sure to run database initialization scripts."),Error("Database error: ".concat(d.message));return n||[]}catch(e){throw console.error("Error in getMaintenanceRequests:",e),e}},n=async e=>{let t={...e,reported_date:new Date().toISOString(),status:e.status||"pending"},{data:r,error:s}=await a.N.from("maintenance_requests").insert([t]).select().single();if(s)throw s;return r},d=async e=>{let{data:t,error:r}=await a.N.from("maintenance_items").insert([e]).select().single();if(r)throw r;return t}}},e=>{var t=t=>e(e.s=t);e.O(0,[851,874,441,684,358],()=>t(6170)),_N_E=e.O()}]);