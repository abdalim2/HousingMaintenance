(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2099:(e,r,t)=>{"use strict";t.d(r,{N:()=>s});let s=(0,t(851).UU)("zzzzz","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10aWN2bXlmcmRtY2lhZWlwZnh1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEwODc1OTMsImV4cCI6MjA1NjY2MzU5M30.6iudxBl6js0heW1mhoSmcXegTIN_lAN2GiFeA3plSIo")},2295:(e,r,t)=>{Promise.resolve().then(t.bind(t,3792))},3792:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(5155),a=t(2115),n=t(6874),i=t.n(n),l=t(9684),d=t(6269),o=t(8072);function c(){let[e,r]=(0,a.useState)(0),[t,n]=(0,a.useState)(0),[c,h]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[g,u]=(0,a.useState)(!0),[p,j]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{try{let e=await (0,l.Om)(void 0,void 0,"pending");r(e.length);let t=await (0,l.Om)(void 0,void 0,"in_progress");n(t.length);let s=await (0,d.d2)(5);h(s);let a=await (0,o.LH)();x(a.slice(0,5)),j(null)}catch(e){console.error("Error fetching dashboard data:",e),j("فشل في تحميل بيانات لوحة التحكم: ".concat(e.message||"خطأ غير معروف"))}finally{u(!1)}})()},[]),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"مرحباً بك في نظام إدارة المجمعات السكنية"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"نظرة عامة على حالة النظام والأنشطة الأخيرة"})]}),p&&(0,s.jsx)("div",{className:"mb-6 p-4 border-r-4 border-danger-600 bg-danger-50 dark:bg-danger-900/30 dark:border-danger-500 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-danger-600 dark:text-danger-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsx)("div",{className:"mr-3",children:(0,s.jsx)("p",{className:"text-sm text-danger-600 dark:text-danger-500",children:p})}),(0,s.jsx)("button",{className:"mr-auto p-1.5 rounded-md text-danger-600 dark:text-danger-500 hover:bg-danger-100 dark:hover:bg-danger-800",onClick:()=>j(null),"aria-label":"إغلاق",children:(0,s.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),g?(0,s.jsx)("div",{className:"card flex items-center justify-center py-16",children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"جاري تحميل البيانات..."})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"stat-card card-hover",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"stat-label",children:"طلبات صيانة معلقة"}),(0,s.jsx)("p",{className:"stat-value text-primary-600 dark:text-primary-400",children:e})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-primary-100 dark:bg-primary-900/50 text-primary-600 dark:text-primary-400",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(i(),{href:"/maintenance?status=pending",className:"text-sm text-primary-600 dark:text-primary-400 hover:underline font-medium inline-flex items-center",children:["عرض الطلبات",(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 rtl:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,s.jsxs)("div",{className:"stat-card card-hover",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"stat-label",children:"صيانة قيد التنفيذ"}),(0,s.jsx)("p",{className:"stat-value text-secondary-600 dark:text-secondary-400",children:t})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-secondary-100 dark:bg-secondary-900/50 text-secondary-600 dark:text-secondary-400",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(i(),{href:"/maintenance?status=in_progress",className:"text-sm text-secondary-600 dark:text-secondary-400 hover:underline font-medium inline-flex items-center",children:["المزيد من التفاصيل",(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 rtl:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,s.jsxs)("div",{className:"stat-card card-hover",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"stat-label",children:"أصناف منخفضة المخزون"}),(0,s.jsx)("p",{className:"stat-value text-warning-600 dark:text-warning-400",children:c.length})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-warning-100 dark:bg-warning-900/50 text-warning-600 dark:text-warning-400",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(i(),{href:"/inventory",className:"text-sm text-warning-600 dark:text-warning-400 hover:underline font-medium inline-flex items-center",children:["إدارة المخزون",(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 rtl:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),(0,s.jsxs)("div",{className:"stat-card card-hover",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"stat-label",children:"طلبات الشراء الجديدة"}),(0,s.jsx)("p",{className:"stat-value text-accent-600 dark:text-accent-400",children:m.length})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-accent-100 dark:bg-accent-900/50 text-accent-600 dark:text-accent-400",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(i(),{href:"/purchase-orders",className:"text-sm text-accent-600 dark:text-accent-400 hover:underline font-medium inline-flex items-center",children:["عرض طلبات الشراء",(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 rtl:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),(0,s.jsxs)("div",{className:"card mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-6",children:"إجراءات سريعة"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,s.jsxs)(i(),{href:"/maintenance/new",className:"flex flex-col items-center justify-center p-6 text-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-primary-50 dark:hover:bg-gray-700/60 transition-colors group",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 group-hover:bg-primary-200 dark:group-hover:bg-primary-800/50 mb-3",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"طلب صيانة جديد"})]}),(0,s.jsxs)(i(),{href:"/purchase-orders/new",className:"flex flex-col items-center justify-center p-6 text-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-secondary-50 dark:hover:bg-gray-700/60 transition-colors group",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-secondary-100 dark:bg-secondary-900/30 text-secondary-600 dark:text-secondary-400 group-hover:bg-secondary-200 dark:group-hover:bg-secondary-800/50 mb-3",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"طلب شراء جديد"})]}),(0,s.jsxs)(i(),{href:"/inventory/file-processor",className:"flex flex-col items-center justify-center p-6 text-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-green-50 dark:hover:bg-gray-700/60 transition-colors group",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 group-hover:bg-green-200 dark:group-hover:bg-green-800/50 mb-3",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"رفع بيانات المخزون"})]}),(0,s.jsxs)(i(),{href:"/housing/management",className:"flex flex-col items-center justify-center p-6 text-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-purple-50 dark:hover:bg-gray-700/60 transition-colors group",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 group-hover:bg-purple-200 dark:group-hover:bg-purple-800/50 mb-3",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"إدارة المجمعات"})]}),(0,s.jsxs)(i(),{href:"/reports",className:"flex flex-col items-center justify-center p-6 text-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-blue-50 dark:hover:bg-gray-700/60 transition-colors group",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 group-hover:bg-blue-200 dark:group-hover:bg-blue-800/50 mb-3",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"التقارير"})]}),(0,s.jsxs)(i(),{href:"/purchase-orders/monthly",className:"flex flex-col items-center justify-center p-6 text-center bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-yellow-50 dark:hover:bg-gray-700/60 transition-colors group",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400 group-hover:bg-yellow-200 dark:group-hover:bg-yellow-800/50 mb-3",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"طلبات شهرية"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"أحدث طلبات الصيانة"}),(0,s.jsx)(i(),{href:"/maintenance",className:"text-primary-600 dark:text-primary-400 text-sm font-medium hover:underline",children:"عرض الكل"})]}),0===e&&0===t?(0,s.jsxs)("div",{className:"py-8 text-center",children:[(0,s.jsx)("div",{className:"inline-flex items-center justify-center rounded-full bg-primary-100 dark:bg-primary-900/30 p-3 mb-4",children:(0,s.jsx)("svg",{className:"h-8 w-8 text-primary-600 dark:text-primary-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-1",children:"جميع طلبات الصيانة مكتملة"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"لا توجد طلبات صيانة معلقة أو قيد التنفيذ حالياً"}),(0,s.jsx)(i(),{href:"/maintenance/new",className:"btn btn-sm btn-primary",children:"إنشاء طلب جديد"})]}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"رقم الطلب"}),(0,s.jsx)("th",{children:"الموقع"}),(0,s.jsx)("th",{children:"الحالة"}),(0,s.jsx)("th",{children:"الأولوية"}),(0,s.jsx)("th",{children:"التاريخ"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"font-medium",children:"#a93b50"}),(0,s.jsx)("td",{children:"المجمع الشرقي - مبنى 3"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge badge-warning",children:"قيد الانتظار"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge badge-danger",children:"عالية"})}),(0,s.jsx)("td",{dir:"ltr",children:"2025-04-25"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"font-medium",children:"#c25e71"}),(0,s.jsx)("td",{children:"المجمع الغربي - مبنى 1"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge badge-primary",children:"قيد التنفيذ"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge badge-warning",children:"متوسطة"})}),(0,s.jsx)("td",{dir:"ltr",children:"2025-04-24"})]})]})]})})]}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"الأصناف منخفضة المخزون"}),(0,s.jsx)(i(),{href:"/inventory",className:"text-primary-600 dark:text-primary-400 text-sm font-medium hover:underline",children:"إدارة المخزون"})]}),0===c.length?(0,s.jsxs)("div",{className:"py-8 text-center",children:[(0,s.jsx)("div",{className:"inline-flex items-center justify-center rounded-full bg-success-100 dark:bg-success-900/30 p-3 mb-4",children:(0,s.jsx)("svg",{className:"h-8 w-8 text-success-600 dark:text-success-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-1",children:"مستويات المخزون جيدة"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"جميع الأصناف متوفرة بكميات كافية"}),(0,s.jsx)(i(),{href:"/inventory",className:"btn btn-sm btn-success",children:"عرض المخزون"})]}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"الصنف"}),(0,s.jsx)("th",{children:"الفئة"}),(0,s.jsx)("th",{children:"الكمية المتاحة"}),(0,s.jsx)("th",{children:"الإجراءات"})]})}),(0,s.jsx)("tbody",{children:c.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"font-medium",children:e.name||"صنف غير معرف"}),(0,s.jsx)("td",{children:e.category||"بدون فئة"}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mr-2",children:(0,s.jsx)("div",{className:"bg-danger-600 h-2.5 rounded-full",style:{width:"".concat(Math.min(Math.max(20*(e.quantity||0),5),100),"%")}})}),(0,s.jsxs)("span",{children:[e.quantity," ",e.unit]})]})}),(0,s.jsx)("td",{children:(0,s.jsx)(i(),{href:"/purchase-orders/new?item=".concat(e.item_id),className:"text-primary-600 dark:text-primary-400 hover:underline text-sm",children:"طلب شراء"})})]},e.id))})]})})]})]})]})]})}},6269:(e,r,t)=>{"use strict";t.d(r,{JS:()=>d,K7:()=>l,ZK:()=>o,bW:()=>a,d2:()=>h,st:()=>i,x8:()=>c,zZ:()=>n});var s=t(2099);let a=async()=>{let{data:e,error:r}=await s.N.from("categories").select("*");if(r)throw r;return e||[]},n=async e=>{let{data:r,error:t}=await s.N.from("categories").insert([e]).select().single();if(t)throw t;return r},i=async(e,r)=>{let{data:t,error:a}=await s.N.from("categories").update(r).eq("id",e).select().single();if(a)throw a;return t},l=async e=>{let{error:r}=await s.N.from("categories").delete().eq("id",e);if(r)throw r},d=async e=>{let r=s.N.from("items").select("*");e&&(r=r.eq("category_id",e));let{data:t,error:a}=await r;if(a)throw a;return t||[]},o=async e=>{let r=s.N.from("inventory").select("\n      *,\n      items:item_id (\n        id,\n        name,\n        category_id,\n        unit\n      )\n    ");e&&(r=r.eq("item_id",e));let{data:t,error:a}=await r;if(a)throw a;return t||[]},c=async(e,r)=>{let{data:t,error:a}=await s.N.from("inventory").select("*").eq("item_id",e).single();if(a&&"PGRST116"!==a.code)throw a;if(t){let e=t.quantity+r;if(e<0)throw Error("Insufficient inventory quantity");let{data:a,error:n}=await s.N.from("inventory").update({quantity:e,last_updated:new Date().toISOString()}).eq("id",t.id).select().single();if(n)throw n;return a}if(r>0){let{data:t,error:a}=await s.N.from("inventory").insert([{item_id:e,quantity:r,last_updated:new Date().toISOString()}]).select().single();if(a)throw a;return t}throw Error("Cannot reduce quantity of non-existent inventory item")},h=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,{data:r,error:t}=await s.N.from("inventory").select("\n      *,\n      items:item_id (\n        id,\n        name,\n        category_id,\n        unit\n      )\n    ").lte("quantity",e);if(t)throw t;return r||[]}},8072:(e,r,t)=>{"use strict";t.d(r,{LH:()=>a,VE:()=>i,_O:()=>l,oC:()=>n});var s=t(2099);let a=async e=>{try{let r=s.N.from("purchase_orders").select("*");e&&(r=r.eq("status",e));let{data:t,error:a}=await r.order("order_date",{ascending:!1});if(a)throw console.error("Supabase error in getPurchaseOrders:",a),a.message.includes("does not exist")&&console.warn("The purchase_orders table might not exist yet. Make sure to run database initialization scripts."),Error("Database error: ".concat(a.message));return t||[]}catch(e){throw console.error("Error in getPurchaseOrders:",e),e}},n=async e=>{let r={...e,order_date:new Date().toISOString(),status:e.status||"draft"},{data:t,error:a}=await s.N.from("purchase_orders").insert([r]).select().single();if(a)throw a;return t},i=async e=>{let{data:r,error:t}=await s.N.from("purchase_items").insert([e]).select().single();if(t)throw t;return r},l=async(e,r,t)=>{try{let a=new Date(e,r-1,1).toISOString(),n=new Date(e,r,0).toISOString(),{data:i,error:l}=await s.N.from("maintenance_requests").select("id").gte("reported_date",a).lte("reported_date",n);if(l){if(l.message.includes("does not exist"))return console.warn("Maintenance requests table does not exist yet. Creating empty purchase order."),d(e,r,t);throw l}if(!i||0===i.length)return console.log("No maintenance requests found for the specified month. Creating empty purchase order."),d(e,r,t);let o=i.map(e=>e.id),{data:c,error:h}=await s.N.from("maintenance_items").select("*").in("maintenance_id",o);if(h){if(h.message.includes("does not exist"))return console.warn("Maintenance items table does not exist yet. Creating empty purchase order."),d(e,r,t);throw h}if(!c||0===c.length)return console.log("No maintenance items found for the specified month. Creating empty purchase order."),d(e,r,t);let m={};c.forEach(e=>{m[e.item_id]||(m[e.item_id]=0),m[e.item_id]+=e.quantity_needed});let{data:x,error:g}=await s.N.from("purchase_orders").insert([{order_date:new Date().toISOString(),status:"draft",created_by:t,notes:"Auto-generated order for ".concat(e,"-").concat(r.toString().padStart(2,"0"))}]).select().single();if(g)throw g;if(Object.keys(m).length>0){let e=Object.entries(m).map(e=>{let[r,t]=e;return{purchase_order_id:x.id,item_id:r,quantity:t}}),{error:r}=await s.N.from("purchase_items").insert(e);if(r)throw r}return x}catch(e){throw console.error("Error generating monthly purchase order:",e),e}},d=async(e,r,t)=>{let{data:a,error:n}=await s.N.from("purchase_orders").insert([{order_date:new Date().toISOString(),status:"draft",created_by:t,notes:"Auto-generated order for ".concat(e,"-").concat(r.toString().padStart(2,"0")," (No maintenance items found)")}]).select().single();if(n)throw n;return a}},9684:(e,r,t)=>{"use strict";t.d(r,{Dn:()=>n,Om:()=>a,v:()=>i});var s=t(2099);let a=async(e,r,t)=>{try{let a=s.N.from("maintenance_requests").select("*");e&&(a=a.eq("complex_id",e)),r&&(a=a.eq("building_id",r)),t&&(a=a.eq("status",t));let{data:n,error:i}=await a.order("reported_date",{ascending:!1});if(i)throw console.error("Supabase error in getMaintenanceRequests:",i),i.message.includes("does not exist")&&console.warn("The maintenance_requests table might not exist yet. Make sure to run database initialization scripts."),Error("Database error: ".concat(i.message));return n||[]}catch(e){throw console.error("Error in getMaintenanceRequests:",e),e}},n=async e=>{let r={...e,reported_date:new Date().toISOString(),status:e.status||"pending"},{data:t,error:a}=await s.N.from("maintenance_requests").insert([r]).select().single();if(a)throw a;return t},i=async e=>{let{data:r,error:t}=await s.N.from("maintenance_items").insert([e]).select().single();if(t)throw t;return r}}},e=>{var r=r=>e(e.s=r);e.O(0,[851,874,441,684,358],()=>r(2295)),_N_E=e.O()}]);